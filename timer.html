<html>
<head>
    <LINK href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.css" rel="stylesheet" type="text/css">
    <style>

        .actions {
            padding: 10px;
            float: right;
        }

        .button {
            background-color: #0b054c;
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 30px;
            margin: 4px 2px;
            cursor: pointer;
        }

        .time {
            color: #0b054c;
            vertical-align: center;
            text-align: center;
            height: 100%;
            padding: 220px 0px;
        }

        .names {
            position: absolute;
            padding: 10px;
        }

        .name {
            padding: 15px 32px;
            margin: 4px 2px 8px 2px;
            border: 0;
            font-size: 30px;
            display: block;
            color: #0b054c;
            max-width: 180px;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/vue@2.5.17/dist/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.js"></script>
</head>

<body>

<div id="timer" v-bind:style="{backgroundColor: color}">
    <div class="actions">
        <button class="button" @click="reset">Reset</button>
        <button class="button" @click="start">Start</button>
        <button class="button" @click="pause">Pause</button>
    </div>
    <div class="names">
        <input v-for="name in names" class="name" v-model="name.value" v-bind:style="{backgroundColor: nameColor}"/>
    </div>
    <div class="time" v-bind:style="{fontSize: fontSize}">
        {{time}}
    </div>
</div>

</body>

<script>

    var vm = new Vue({
        el: '#timer',
        data: {
            time: 'Hack away!',
            timerSeconds: 10 * 60,
            names: JSON.parse(localStorage.getItem("names")) || [{value: 'Kent B'}, {value: 'Robert C'}, {value: 'Martin F'}, {value: 'Woody Z'}, {value: 'Ward C'}]
        },
        created: function () {
            this.reset();
            this.start();
        },
        watch: {
            names: {
                handler: function (val, oldVal) {
                    localStorage.names = JSON.stringify(val);
                },
                deep: true
            }
        },
        methods: {
            start: function () {
                this.lastTick = moment();
                if (!this.interval)
                    this.interval = setInterval(this.countdown, 100);
            },
            reset: function () {
                this.millisecondsLeft = this.timerSeconds * 1000;
            },
            pause: function () {
                clearInterval(this.interval);
                this.interval = null;
            },
            countdown: function () {
                var now = moment();
                var change = now.diff(this.lastTick);
                this.millisecondsLeft = this.millisecondsLeft - change;
                if (this.millisecondsLeft <= 0) {
                    this.time = 'Time is up!';
                    this.color = '#ff0000';
                    this.nameColor = '#ee0000';
                    this.fontSize = '300px';
                } else {
                    this.time = moment.utc(this.millisecondsLeft).format("mm:ss");
                    this.color = '#66aa66';
                    this.nameColor = '#669966';
                    this.fontSize = '500px';
                }
                this.lastTick = moment();
            }

        },
        beforeDestroy: function () {
            this.pause();
        }
    });


</script>


</html>
